!function(n,e){"undefined"!=typeof module&&module.exports?module.exports=e(require("elliptical-utils"),require("dustjs"),require("elliptical-mutation-summary")):"function"==typeof define&&define.amd?define(["elliptical-utils","dustjs","elliptical-mutation-summary"],e):(n.elliptical=n.elliptical||{},n.elliptical.binding=e(n.elliptical.utils,n.dust,n.elliptical.mutation.summary),n.returnExports=n.elliptical.binding)}(this,function(n,e,t){function o(){$(document).on("OnDocumentMutation",function(n,e){e.added&&u(e.added),e.removed&&f(e.removed)})}function i(n,e){g||o(),g=!0;var t=x.obj;t.fn=e,t.context=this,I.set(n,t),this.click="touchclick",this._events=[]}function l(n,t){n=n.replace(/&quot;/g,'"');var o=e.compile(n,t);e.loadSource(o)}function r(n,t,o,i){e.render(t,o,function(e,t){(t||""===t)&&(n.innerHTML=t),i&&i(e,t)})}function c(n,e,t,o){var i="template-"+v.str(6);l(e,i),r(n,i,t,o)}function u(n){I.forEach(function(e,t){var o=$(n).selfFind("["+h+'="'+t+'"]');o[0]&&$.each(o,function(n,o){var i=v.id(8);o._EA_BINDING_ID=i;var l=j.obj;l.node=o,l.context=e.context,l.attrValue=t,l.fn=e.fn,_.set(i,l),a(e.context,o,e.fn)})})}function a(n,e,t){setTimeout(function(){t.call(n,e)},y)}function f(n){var e=$(n).selfFind(m);e.length&&e.length>0&&$.each(e,function(n,e){e._EA_BINDING_ID&&s(e)})}function s(n){var e=n._EA_BINDING_ID,t=_.get(e);void 0===t?p(n):d(t,n,e)}function d(n,e,t){n.context.unbindEvents(),n.context.dispose(),n.context=null,e&&e.parentNode&&e.parentNode.removeChild(e),n.fn=null,n.node=null,_["delete"](t)}function p(n){_.forEach(function(e,t){n===t.node&&d(t,n,e)})}var v=n.random,m="[ea-bind]",h="ea-bind",g=!1,y=500,b=250,I=new Map,_=new Map;t.connect();var x={get obj(){return{fn:null,context:null}}},j={get obj(){return{node:null,context:null,fn:null,attrValue:null}}};return $(function(){var n=document.querySelectorAll(m);n.length&&setTimeout(function(){u(n)},b)}),i.prototype.jsonParseMessage=function(n){try{var e=JSON.parse(n);return e.message?e.message:n}catch(t){return n}},i.prototype.render=function(n,e,t,o){c(n,e,t,o)},i.prototype.preload=function(n,e){var t=[],o={},i=$(n),l=i.find("img"),r=l.length,c=0;return 0===r?(e&&e(null),!1):($.each(l,function(n,i){var l=new Image;$(l).bind("load",function(n){c++,t.push(l),c===r&&e&&(o.images=t,o.length=c,e(o))}),l.src=i.src}),!0)},i.prototype.load=function(n,e){var t=new Image;t.onload=function(){e(this)},t.src=n},i.prototype.component=function(n,e,t){if(n[e])return t(n[e].bind(n));var o=0,i=20,l=setInterval(function(){n[e]?(clearInterval(l),t(n[e].bind(n))):i>o?o++:(clearInterval(l),t(n[e].bind(n)))},300)},i.prototype.dispose=function(){},i.prototype.event=function(n,e,t,o){var i={};i.element=n,i.event=e;var l=arguments.length;3===l&&(o="function"==typeof t?t:null,t=null),i.selector=t,i.callback=o;var r=this._events;-1===$.inArray(i,r)&&this._events.push(i),t?n.on(e,t,function(){var n=[].slice.call(arguments);o&&o.apply(this,n)}):n.on(e,function(){var n=[].slice.call(arguments);o&&o.apply(this,n)})},i.prototype.unbindEvents=function(){for(var n=this._events,e=n.length,t=0;e>t;t++){var o=n[t];o.selector?o.element.off(o.event,o.selector):o.element.off(o.event)}n.length=0},function(n,e){return new i(n,e)}});